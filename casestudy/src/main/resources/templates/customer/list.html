<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Show blog list</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>
</head>
<body>
<h1>Blog list</h1>

<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalCreate">
    Create Blog
</button>

<input type="text" name="nameSearch" placeholder="Input name" id="nameSearch">
<input class="btn btn-secondary" type="submit" value="Search" id="search">

<table class="table table-success table-striped">
    <tr>
        <td>STT</td>
        <td>Name</td>
        <td>Date Birth</td>
        <td>Gender</td>
        <td>Id Card</td>
        <td>Phone</td>
        <td>Email</td>
        <td>Address</td>
        <td>Customer Type</td>
        <!--        <td>Edit</td>-->
        <!--        <td>Delete</td>-->
        <!--        <td>View</td>-->
    </tr>
    <tr th:each="data, a : ${customerDto}">
        <td th:text="${a.count}"></td>
        <td th:text="${data.name}"></td>
        <td th:text="${data.dateOfBirth}"></td>
        <td th:text="${data.gender}"></td>
        <td th:text="${data.idCard}"></td>
        <td th:text="${data.phoneNumber}"></td>
        <td th:text="${data.email}"></td>
        <td th:text="${data.address}"></td>
        <td th:text="${data.nameCustomerType}"></td>
        <!--            <td><a th:href="@{/edit-blog/__${customerDto.getIdBlog()}__}">edit</a></td>-->
        <!--            <td><a th:href="@{/delete-blog/__${customerDto.getIdBlog()}__}">delete</a></td>-->
        <!--            <td><a th:href="@{/view-blog/__${customerDto.getIdBlog()}__}">view</a></td>-->
    </tr>
</table>
<div>
    <a th:href="@{'/customer'(page=${customerDto.number - 1})}"
       th:if="${customerDto.hasPrevious()}">Previous</a>
    <span th:text="${customerDto.number+1}"></span>
    <span th:text="${customerDto.totalPages}"></span>

    <a th:href="@{'/customer'(page=${customerDto.number + 1})}"
       th:if="${customerDto.hasNext()}">Next</a>
</div>


<div class="modal fade" id="modalCreate" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create new Blog</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

                <p>NameBlog:</p>
                <p><input type="text" id="txtName"></p>

                <p>Content:</p>
                <p><input type="text" id="txtContent"></p>

                <p>Image:</p>
                <p><input type="text" id="txtImage"></p>

                <p>Category:</p>
<!--                <select th:field="*{category}">-->
<!--                    <option th:each="category : ${categoryList}" th:value="${category.id}"-->
<!--                            th:text="${category.name}">-->
<!--                </select>-->

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="btnCreate">Save changes</button>
            </div>
        </div>
    </div>
</div>

<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>-->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>

<script>

    $(document).ready(function () {
        function init() {
            setTimeout(function () {
                $("tbody").empty();
                $.ajax({
                    url: "http://localhost:8080/api/blogger/v1",
                    type: "GET",
                    dataType: "json",
                    success: function (data) {
                        let tr = [];
                        for (let i = 0; i < data.length; i++) {
                            tr.push("<tr>")
                            tr.push("<td>" + data[i].name + "</td>");
                            tr.push("<td>" + data[i].content + "</td>");
                            tr.push("<td>" + data[i].image + "</td>");
                            tr.push("<td>" + data[i].categoryId + "</td>");
                            tr.push("<td>" + "<button class=\"btn btn-warning\">Edit</button>" + "</td>");
                            tr.push("<td>" + "<button class=\"btn btn-danger\">Delete</button>" + "</td>");
                            tr.push("<td>" + "<button class=\"btn btn-primary\">View</button>" + "</td>");
                            tr.push("</tr>")
                        }
                        $("tbody").append(tr.join(""));
                    }
                })
            }, 500);
        }

        init();

        $("#search").click(function () {
            $("tbody").empty();
            let nameSearch = $("#nameSearch").val();
            $.ajax({
                url: "http://localhost:8080/api/blogger/v1/search?nameInput=" + nameSearch,
                type: "GET",
                contentType: "application/json; charset =utf-8",
                dataType: "json",
                success: function (dataSearcher) {
                    let tr = [];
                    for (let i = 0; i < dataSearcher.length; i++) {
                        tr.push("<tr>")
                        tr.push("<td>" + dataSearcher[i].name + "</td>");
                        tr.push("<td>" + dataSearcher[i].content + "</td>");
                        tr.push("<td>" + dataSearcher[i].image + "</td>");
                        tr.push("<td>" + dataSearcher[i].categoryId + "</td>");
                        tr.push("<td>" + "<button class=\"btn btn-warning\">Edit</button>" + "</td>");
                        tr.push("<td>" + "<button class=\"btn btn-danger\">Delete</button>" + "</td>");
                        tr.push("<td>" + "<button class=\"btn btn-primary\">View</button>" + "</td>");
                        tr.push("</tr>")
                    }
                    $("tbody").append(tr.join(""));
                }
            })
        })


    })
</script>
</body>
</html>